import{r as x,u as w,j as e,H as _,b as c}from"./app-WGHfEhgb.js";import{A as C,i as m,D as S}from"./AuthenticatedLayout-nRhbumud.js";import{C as D}from"./circle-check-big-3JtwHLRG.js";import{C as M}from"./circle-x-CKxGErSt.js";import{L}from"./loader-circle-CRpS_N1P.js";import{c as P}from"./createLucideIcon-ChO7t9oX.js";import{T as o}from"./trash-2-B_OpaBCO.js";import"./phone-Cb-uENet.js";const F=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],A=P("refresh-cw",F);function J({batches:s,flash:l}){const[a,r]=x.useState(null),{data:p,setData:u,post:h,processing:i,errors:d,reset:f}=w({fail:null}),n=x.useRef(null),g=t=>{u("fail",t.target.files[0])},j=t=>{t.preventDefault(),h(route("upload-database.store"),{forceFormData:!0,onSuccess:()=>{f(),n.current&&(n.current.value="")}})},N=t=>{c.post(route("upload-database.restore",t.id))},b=t=>{r(t)},y=()=>{a&&c.delete(route("upload-database.destroy",a.id),{onFinish:()=>r(null)})},v=t=>{switch(t){case"completed":return e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Selesai"});case"processing":return e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Memproses"});case"failed":return e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Gagal"});default:return null}};return e.jsxs(C,{children:[e.jsx(_,{title:"Upload Database Pengundi"}),e.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Upload Database Pengundi"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Muat naik fail ZIP yang mengandungi data pengundi (format: DUN › Daerah Mengundi › LOCALITIES › *.xlsx)"})]}),l?.success&&e.jsxs("div",{className:"flex items-center gap-3 bg-green-50 border border-green-200 text-green-800 rounded-lg px-4 py-3",children:[e.jsx(D,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:l.success})]}),l?.error&&e.jsxs("div",{className:"flex items-center gap-3 bg-red-50 border border-red-200 text-red-800 rounded-lg px-4 py-3",children:[e.jsx(M,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:l.error})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(m,{className:"h-5 w-5"}),"Muat Naik Fail ZIP"]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Fail ZIP ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{ref:n,type:"file",accept:".zip",onChange:g,className:"block w-full text-sm text-slate-700 border border-slate-300 rounded-lg cursor-pointer bg-slate-50 focus:outline-none file:mr-4 file:py-2 file:px-4 file:rounded-l-lg file:border-0 file:text-sm file:font-medium file:bg-slate-900 file:text-white hover:file:bg-slate-800",required:!0}),d.fail&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:d.fail}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Hanya fail .zip sahaja. Saiz maksimum: 100MB."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"submit",disabled:i||!p.fail,className:"flex items-center gap-2 px-6 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"h-4 w-4 animate-spin"}),"Memproses... (sila tunggu)"]}):e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"h-4 w-4"}),"Muat Naik & Proses"]})}),i&&e.jsx("p",{className:"text-sm text-slate-500",children:"Pemprosesan mungkin mengambil masa 30–60 saat. Jangan tutup halaman ini."})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5"}),"Sejarah Muat Naik"]}),s.data.length===0?e.jsx("p",{className:"text-sm text-slate-500 text-center py-8",children:"Tiada rekod muat naik."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("th",{className:"text-left py-3 px-3 font-medium text-slate-600",children:"Bil"}),e.jsx("th",{className:"text-left py-3 px-3 font-medium text-slate-600",children:"Nama Fail"}),e.jsx("th",{className:"text-left py-3 px-3 font-medium text-slate-600",children:"Tarikh Upload"}),e.jsx("th",{className:"text-right py-3 px-3 font-medium text-slate-600",children:"Jumlah Rekod"}),e.jsx("th",{className:"text-center py-3 px-3 font-medium text-slate-600",children:"Status"}),e.jsx("th",{className:"text-center py-3 px-3 font-medium text-slate-600",children:"Aktif"}),e.jsx("th",{className:"text-center py-3 px-3 font-medium text-slate-600",children:"Tindakan"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:s.data.map((t,k)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"py-3 px-3 text-slate-600",children:(s.current_page-1)*s.per_page+k+1}),e.jsx("td",{className:"py-3 px-3 text-slate-900 font-medium max-w-xs truncate",children:t.nama_fail}),e.jsx("td",{className:"py-3 px-3 text-slate-600",children:new Date(t.created_at).toLocaleString("ms-MY",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("td",{className:"py-3 px-3 text-slate-900 text-right",children:t.jumlah_rekod.toLocaleString()}),e.jsx("td",{className:"py-3 px-3 text-center",children:v(t.status)}),e.jsx("td",{className:"py-3 px-3 text-center",children:t.is_active?e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Aktif"}):e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-600",children:"Tidak Aktif"})}),e.jsx("td",{className:"py-3 px-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("button",{onClick:()=>N(t),disabled:t.is_active,title:"Jadikan aktif",className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-100 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",children:[e.jsx(A,{className:"h-3 w-3"}),"Restore"]}),e.jsxs("button",{onClick:()=>b(t),title:"Padam",className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium rounded-lg border border-red-300 text-red-700 hover:bg-red-50 transition-colors",children:[e.jsx(o,{className:"h-3 w-3"}),"Padam"]})]})})]},t.id))})]})}),s.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-slate-200",children:[e.jsxs("p",{className:"text-sm text-slate-600",children:["Halaman ",s.current_page," daripada ",s.last_page]}),e.jsxs("div",{className:"flex gap-2",children:[s.prev_page_url&&e.jsx("a",{href:s.prev_page_url,className:"px-3 py-1.5 text-sm border border-slate-300 rounded-lg hover:bg-slate-100",children:"Sebelum"}),s.next_page_url&&e.jsx("a",{href:s.next_page_url,className:"px-3 py-1.5 text-sm border border-slate-300 rounded-lg hover:bg-slate-100",children:"Seterusnya"})]})]})]})]})]}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(o,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-slate-900",children:"Padam Rekod"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Tindakan ini tidak boleh diundur."})]})]}),e.jsxs("p",{className:"text-sm text-slate-700",children:["Adakah anda pasti mahu memadam ",e.jsx("strong",{children:a.nama_fail}),"? Semua ",e.jsx("strong",{children:a.jumlah_rekod.toLocaleString()})," rekod pengundi akan dipadam bersama."]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx("button",{onClick:()=>r(null),className:"px-4 py-2 text-sm border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50",children:"Batal"}),e.jsx("button",{onClick:y,className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Ya, Padam"})]})]})})]})}export{J as default};
