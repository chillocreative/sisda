import{r as o,u as O,j as e,H as q,c as k}from"./app-DscXeIeP.js";import{A as I}from"./AuthenticatedLayout-D1hGOp_m.js";import{A as P}from"./AsyncSearchableSelectWithCallback-BBA8xMfD.js";import{A as B}from"./arrow-left-Bso2QYjj.js";import"./createLucideIcon-Bx4M0S6F.js";import"./phone-BfP1f9-w.js";import"./check-df_P2s0-.js";import"./index-D4lKKhPF.js";import"./portal-CDvM-BNv.js";import"./transition-DZed2T2I.js";import"./with-selector-BeRdBTEg.js";function ee({dataPengundi:l,bangsaList:v,negeriList:F,bandarList:U,kadunList:H,daerahMengundiList:Y,keahlianPartiList:y,kecenderunganPolitikList:_}){const[w,c]=o.useState([]),[p,b]=o.useState(!1),[D,m]=o.useState([]),[g,f]=o.useState(!1),{data:t,setData:r,put:C,processing:j,errors:s}=O({nama:l.nama||"",no_ic:l.no_ic||"",umur:l.umur||"",no_tel:l.no_tel||"",bangsa:l.bangsa||"",alamat:l.alamat||"",poskod:l.poskod||"",negeri:l.negeri||"",bandar:l.bandar||"",parlimen:l.parlimen||"",kadun:l.kadun||"",daerah_mengundi:l.daerah_mengundi||"",keahlian_parti:l.keahlian_parti||"",kecenderungan_politik:l.kecenderungan_politik||""});o.useEffect(()=>{(async()=>{if(!t.bandar){c([]);return}b(!0);try{const n=await k.get(route("api.kadun.by-bandar"),{params:{bandar:t.bandar}});c(n.data)}catch(n){console.error("Error fetching KADUN:",n),c([])}finally{b(!1)}})()},[t.bandar]),o.useEffect(()=>{(async()=>{if(!t.bandar){m([]);return}f(!0);try{const n=await k.get(route("api.daerah-mengundi.by-bandar"),{params:{bandar:t.bandar}});m(n.data)}catch(n){console.error("Error fetching Daerah Mengundi:",n),m([])}finally{f(!1)}})()},[t.bandar]);const M=a=>{a&&r(n=>({...n,poskod:a.postcode,negeri:a.negeri_nama||"",bandar:a.bandar_nama||"",parlimen:a.bandar_nama||"",kadun:"",daerah_mengundi:""}))},K=a=>{const i=a.target.value.replace(/\D/g,"");if(i.length>12)return;if(r("no_ic",i),i.length<6){r("umur","");return}const u=i.substring(0,2),A=i.substring(2,4),L=i.substring(4,6),E=parseInt(u)<=25?2e3+parseInt(u):1900+parseInt(u),x=new Date(E,parseInt(A)-1,parseInt(L)),h=new Date;let d=h.getFullYear()-x.getFullYear();const N=h.getMonth()-x.getMonth();(N<0||N===0&&h.getDate()<x.getDate())&&d--,d>=0&&d<=150&&r("umur",d.toString())},S=a=>{a.preventDefault(),C(route("reports.data-pengundi.update",l.id))};return e.jsxs(I,{children:[e.jsx(q,{title:"Edit Data Pengundi"}),e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>window.history.back(),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(B,{className:"h-5 w-5 text-slate-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Edit Data Pengundi"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Kemaskini maklumat pengundi"})]})]}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Maklumat Peribadi"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Nama ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.nama,onChange:a=>r("nama",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0}),s.nama&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.nama})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["No. IC ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.no_ic,onChange:K,placeholder:"900101145678",maxLength:"12",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0}),s.no_ic&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.no_ic}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Hanya angka sahaja (contoh: 900101145678)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Umur ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"number",value:t.umur,onChange:a=>r("umur",a.target.value),min:"1",max:"150",readOnly:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400 bg-slate-50",required:!0}),s.umur&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.umur}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Dikira automatik dari No. IC"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["No. Telefon ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"tel",value:t.no_tel,onChange:a=>r("no_tel",a.target.value),placeholder:"0123456789",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0}),s.no_tel&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.no_tel})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Bangsa ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("select",{value:t.bangsa,onChange:a=>r("bangsa",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0,children:[e.jsx("option",{value:"",children:"Pilih Bangsa"}),v.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),s.bangsa&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.bangsa})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Maklumat Alamat"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Alamat ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("textarea",{value:t.alamat,onChange:a=>r("alamat",a.target.value),rows:"3",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0}),s.alamat&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.alamat})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Poskod ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx(P,{value:t.poskod,onChange:a=>r("poskod",a),onSelect:M,routeName:"api.postcodes.search-details",placeholder:"00000",displayField:"postcode"}),s.poskod&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.poskod})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Negeri ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.negeri,readOnly:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400 bg-slate-50",placeholder:"Pilih Poskod terlebih dahulu"}),s.negeri&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.negeri})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Bandar ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.bandar,readOnly:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400 bg-slate-50",placeholder:"Pilih Poskod terlebih dahulu"}),s.bandar&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.bandar})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Parlimen ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.parlimen,readOnly:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400 bg-slate-50",placeholder:"Pilih Poskod terlebih dahulu"}),s.parlimen&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.parlimen})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["KADUN ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("select",{value:t.kadun,onChange:a=>r("kadun",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",disabled:!t.bandar||p,required:!0,children:[e.jsx("option",{value:"",children:p?"Loading...":"Pilih KADUN"}),w.map(a=>e.jsxs("option",{value:a.nama,children:[a.kod_dun," - ",a.nama]},a.id))]}),s.kadun&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.kadun})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Daerah Mengundi ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("select",{value:t.daerah_mengundi,onChange:a=>r("daerah_mengundi",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",disabled:g,required:!0,children:[e.jsx("option",{value:"",children:g?"Loading...":"Pilih Daerah Mengundi"}),D.map(a=>e.jsxs("option",{value:a.nama,children:[a.kod_dm," - ",a.nama]},a.id))]}),s.daerah_mengundi&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.daerah_mengundi})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Maklumat Politik"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Keahlian Parti"}),e.jsxs("select",{value:t.keahlian_parti,onChange:a=>r("keahlian_parti",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",children:[e.jsx("option",{value:"",children:"Pilih Keahlian Parti"}),y.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),s.keahlian_parti&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.keahlian_parti})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Kecenderungan Politik"}),e.jsxs("select",{value:t.kecenderungan_politik,onChange:a=>r("kecenderungan_politik",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",children:[e.jsx("option",{value:"",children:"Pilih Kecenderungan Politik"}),_.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),s.kecenderungan_politik&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.kecenderungan_politik})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pb-6",children:[e.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"px-6 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",disabled:j,className:"px-6 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors disabled:opacity-50",children:j?"Menyimpan...":"Simpan"})]})]})]})]})}export{ee as default};
