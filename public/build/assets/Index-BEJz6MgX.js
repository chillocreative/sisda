import{r as l,j as e,H as G,b as o}from"./app-B2oWfsIg.js";import{A as J,a as O,U as Q,c as W,X as Y}from"./AuthenticatedLayout-DKBr3Dsa.js";import{I as r}from"./InputLabel-DG9NDpaj.js";import{T as c}from"./TextInput-B-aplajz.js";import{M as Z}from"./Modal-DFqrKr_i.js";import{D as ee}from"./DangerButton-RXuz7Xun.js";import{S as se}from"./SecondaryButton-CgTh5Oxo.js";import{P as ae,S as te}from"./square-pen-Dq5-kSm_.js";import{c as le}from"./createLucideIcon-DO_NnYHa.js";import{F as re}from"./funnel-B7QsTYaX.js";import{T as P}from"./trash-2-Bmx22OVy.js";import"./phone-BtrsRlbF.js";import"./transition-Dvmkk2Xa.js";import"./with-selector-DtXOHp9f.js";import"./index-bqYJhtkS.js";const ne=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],de=le("shield",ne);function ye({users:u,stats:b,negeriList:D,bandarList:y,kadunList:k,filters:i}){const[d,x]=l.useState([]),[t,g]=l.useState(null),[v,j]=l.useState(!1),[N,q]=l.useState(!1),[m,h]=l.useState(null),[f,_]=l.useState({search:i.search||"",role:i.role||"",status:i.status||"",negeri_id:i.negeri_id||"",bandar_id:i.bandar_id||"",kadun_id:i.kadun_id||""}),[a,n]=l.useState({name:"",telephone:"",email:"",password:"",password_confirmation:"",role:"user",status:"pending",negeri_id:"",bandar_id:"",kadun_id:""}),[A,S]=l.useState([]),[T,C]=l.useState([]);l.useEffect(()=>{!v&&!t&&n({name:"",telephone:"",email:"",password:"",password_confirmation:"",role:"user",status:"pending",negeri_id:"",bandar_id:"",kadun_id:""})},[v,t]),l.useEffect(()=>{t&&n({name:t.name,telephone:t.telephone,email:t.email||"",password:"",password_confirmation:"",role:t.role,status:t.status,negeri_id:t.negeri_id,bandar_id:t.bandar_id,kadun_id:t.kadun_id})},[t]),l.useEffect(()=>{a.negeri_id?S(y.filter(s=>s.negeri_id==a.negeri_id)):S([])},[a.negeri_id,y]),l.useEffect(()=>{a.bandar_id?C(k.filter(s=>s.bandar_id==a.bandar_id)):C([])},[a.bandar_id,k]);const w=(s,p)=>{_(X=>({...X,[s]:p}))},B=()=>{o.get(route("users.index"),f,{preserveState:!0})},U=()=>{_({search:"",role:"",status:"",negeri_id:"",bandar_id:"",kadun_id:""}),o.get(route("users.index"))},E=s=>{s.target.checked?x(u.map(p=>p.id)):x([])},L=s=>{d.includes(s)?x(d.filter(p=>p!==s)):x([...d,s])},K=s=>{h(s)},M=()=>{m&&o.delete(route("users.destroy",m.id),{onSuccess:()=>h(null),onError:()=>h(null)})},F=()=>{if(d.length===0){alert("Sila pilih pengguna untuk dipadam");return}confirm(`Adakah anda pasti mahu memadam ${d.length} pengguna?`)&&(o.post(route("users.bulk-delete"),{ids:d}),x([]))},I=s=>{s.preventDefault(),t?o.put(route("users.update",t.id),a,{onSuccess:()=>g(null)}):o.post(route("users.store"),a,{onSuccess:()=>j(!1)})},$=s=>{switch(s){case"super_admin":return"bg-rose-100 text-rose-800";case"admin":return"bg-sky-100 text-sky-800";default:return"bg-slate-100 text-slate-800"}},R=s=>{switch(s){case"approved":return"bg-emerald-100 text-emerald-800";case"rejected":return"bg-rose-100 text-rose-800";default:return"bg-amber-100 text-amber-800"}},z=s=>{switch(s){case"super_admin":return"Super Admin";case"admin":return"Admin";default:return"Pengguna"}},H=s=>{switch(s){case"approved":return"Lulus";case"rejected":return"Ditolak";default:return"Menunggu"}},V=s=>s?new Date(s).toLocaleDateString("en-US",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}):"Tidak pernah";return e.jsxs(J,{children:[e.jsx(G,{title:"Pengguna"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Pengguna"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Urus pengguna sistem"})]}),e.jsxs("button",{onClick:()=>j(!0),className:"flex items-center space-x-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Tambah Pengguna"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"p-3 rounded-lg bg-rose-50",children:e.jsx(de,{className:"h-6 w-6 text-rose-600"})})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Super Admin"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 mt-1",children:b.super_admin})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"p-3 rounded-lg bg-sky-50",children:e.jsx(O,{className:"h-6 w-6 text-sky-600"})})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Admin"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 mt-1",children:b.admin})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"p-3 rounded-lg bg-slate-50",children:e.jsx(Q,{className:"h-6 w-6 text-slate-600"})})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Pengguna"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 mt-1",children:b.user})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50 flex items-center justify-between cursor-pointer",onClick:()=>q(!N),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{className:"h-4 w-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Tapis & Carian"})]}),e.jsx(W,{className:`h-4 w-4 text-slate-400 transition-transform duration-200 ${N?"transform rotate-180":""}`})]}),N&&e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{value:"Carian"}),e.jsx(c,{value:f.search,onChange:s=>w("search",s.target.value),placeholder:"Nama, Telefon, Emel...",className:"w-full mt-1"})]}),e.jsxs("div",{children:[e.jsx(r,{value:"Peranan"}),e.jsxs("select",{value:f.role,onChange:s=>w("role",s.target.value),className:"w-full mt-1 border-slate-300 rounded-lg focus:ring-slate-400 focus:border-slate-400",children:[e.jsx("option",{value:"",children:"Semua"}),e.jsx("option",{value:"super_admin",children:"Super Admin"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"user",children:"Pengguna"})]})]}),e.jsxs("div",{children:[e.jsx(r,{value:"Status"}),e.jsxs("select",{value:f.status,onChange:s=>w("status",s.target.value),className:"w-full mt-1 border-slate-300 rounded-lg focus:ring-slate-400 focus:border-slate-400",children:[e.jsx("option",{value:"",children:"Semua"}),e.jsx("option",{value:"pending",children:"Menunggu"}),e.jsx("option",{value:"approved",children:"Lulus"}),e.jsx("option",{value:"rejected",children:"Ditolak"})]})]}),e.jsxs("div",{className:"md:col-span-3 flex justify-end space-x-2",children:[e.jsx("button",{onClick:U,className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg text-sm",children:"Set Semula"}),e.jsx("button",{onClick:B,className:"px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 text-sm",children:"Tapis"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Senarai Pengguna"}),d.length>0&&e.jsxs("button",{onClick:F,className:"flex items-center space-x-2 px-4 py-2 bg-rose-600 text-white rounded-lg hover:bg-rose-700 transition-colors",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsxs("span",{children:["Padam Terpilih (",d.length,")"]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-6 w-12",children:e.jsx("input",{type:"checkbox",checked:d.length===u.length&&u.length>0,onChange:E,className:"rounded border-slate-300 text-slate-900 focus:ring-slate-400"})}),e.jsx("th",{className:"text-left py-3 px-6 text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Nama / Info"}),e.jsx("th",{className:"text-left py-3 px-6 text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Kawasan"}),e.jsx("th",{className:"text-left py-3 px-6 text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Peranan / Status"}),e.jsx("th",{className:"text-left py-3 px-6 text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Last Login"}),e.jsx("th",{className:"text-right py-3 px-6 text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Tindakan"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[u.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsx("input",{type:"checkbox",checked:d.includes(s.id),onChange:()=>L(s.id),className:"rounded border-slate-300 text-slate-900 focus:ring-slate-400"})}),e.jsxs("td",{className:"py-4 px-6",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:s.name}),e.jsx("div",{className:"text-xs text-slate-500",children:s.telephone}),e.jsx("div",{className:"text-xs text-slate-500",children:s.email})]}),e.jsxs("td",{className:"py-4 px-6",children:[e.jsx("div",{className:"text-xs text-slate-700 font-medium",children:s.negeri?.nama||"-"}),e.jsx("div",{className:"text-xs text-slate-500",children:s.bandar?.nama||"-"}),e.jsx("div",{className:"text-xs text-slate-500",children:s.kadun?.nama||"-"})]}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium w-fit ${$(s.role)}`,children:z(s.role)}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium w-fit ${R(s.status)}`,children:H(s.status)})]})}),e.jsx("td",{className:"py-4 px-6 text-sm text-slate-600",children:V(s.last_login)}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{onClick:()=>g(s),className:"p-2 text-slate-600 hover:text-sky-600 hover:bg-sky-50 rounded-lg transition-colors",children:e.jsx(te,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>K(s),className:"p-2 text-slate-600 hover:text-rose-600 hover:bg-rose-50 rounded-lg transition-colors",children:e.jsx(P,{className:"h-4 w-4"})})]})})]},s.id)),u.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"py-8 text-center text-slate-500",children:"Tiada pengguna dijumpai."})})]})]})})]})]}),(v||t)&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full p-6 my-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:t?"Edit Pengguna":"Tambah Pengguna Baru"}),e.jsx("button",{onClick:()=>{j(!1),g(null)},className:"text-slate-400 hover:text-slate-600",children:e.jsx(Y,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{value:"Nama",required:!0}),e.jsx(c,{value:a.name,onChange:s=>n({...a,name:s.target.value}),className:"w-full mt-1",required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{value:"Nombor Telefon",required:!0}),e.jsx(c,{value:a.telephone,onChange:s=>n({...a,telephone:s.target.value}),className:"w-full mt-1",required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{value:"Emel"}),e.jsx(c,{type:"email",value:a.email,onChange:s=>n({...a,email:s.target.value}),className:"w-full mt-1"})]}),e.jsxs("div",{children:[e.jsx(r,{value:"Kata Laluan",required:!t}),e.jsx(c,{type:"password",value:a.password,onChange:s=>n({...a,password:s.target.value}),className:"w-full mt-1",placeholder:t?"Biarkan kosong jika tidak tukar":"",required:!t})]}),(!t||a.password)&&e.jsxs("div",{children:[e.jsx(r,{value:"Sahkan Kata Laluan",required:!t||a.password}),e.jsx(c,{type:"password",value:a.password_confirmation,onChange:s=>n({...a,password_confirmation:s.target.value}),className:"w-full mt-1",required:!t||a.password})]})]}),e.jsxs("div",{className:"border-t border-slate-200 pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-900 mb-3",children:"Peranan & Status"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{value:"Peranan",required:!0}),e.jsxs("select",{value:a.role,onChange:s=>n({...a,role:s.target.value}),className:"w-full mt-1 border-slate-300 rounded-lg focus:ring-slate-400 focus:border-slate-400",required:!0,children:[e.jsx("option",{value:"user",children:"Pengguna"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),e.jsxs("div",{children:[e.jsx(r,{value:"Status",required:!0}),e.jsxs("select",{value:a.status,onChange:s=>n({...a,status:s.target.value}),className:"w-full mt-1 border-slate-300 rounded-lg focus:ring-slate-400 focus:border-slate-400",required:!0,children:[e.jsx("option",{value:"pending",children:"Menunggu"}),e.jsx("option",{value:"approved",children:"Lulus"}),e.jsx("option",{value:"rejected",children:"Ditolak"})]})]})]})]}),e.jsxs("div",{className:"border-t border-slate-200 pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-900 mb-3",children:"Kawasan"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{value:"Negeri",required:!0}),e.jsxs("select",{value:a.negeri_id,onChange:s=>n({...a,negeri_id:s.target.value,bandar_id:"",kadun_id:""}),className:"w-full mt-1 border-slate-300 rounded-lg focus:ring-slate-400 focus:border-slate-400",required:!0,children:[e.jsx("option",{value:"",children:"Pilih Negeri"}),D.map(s=>e.jsx("option",{value:s.id,children:s.nama},s.id))]})]}),e.jsxs("div",{children:[e.jsx(r,{value:"Bandar / Parlimen",required:!0}),e.jsxs("select",{value:a.bandar_id,onChange:s=>n({...a,bandar_id:s.target.value,kadun_id:""}),className:"w-full mt-1 border-slate-300 rounded-lg focus:ring-slate-400 focus:border-slate-400",required:!0,disabled:!a.negeri_id,children:[e.jsx("option",{value:"",children:"Pilih Bandar"}),A.map(s=>e.jsx("option",{value:s.id,children:s.nama},s.id))]})]}),e.jsxs("div",{children:[e.jsx(r,{value:"KADUN",required:!0}),e.jsxs("select",{value:a.kadun_id,onChange:s=>n({...a,kadun_id:s.target.value}),className:"w-full mt-1 border-slate-300 rounded-lg focus:ring-slate-400 focus:border-slate-400",required:!0,disabled:!a.bandar_id,children:[e.jsx("option",{value:"",children:"Pilih KADUN"}),T.map(s=>e.jsx("option",{value:s.id,children:s.nama},s.id))]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 mt-6 pt-4 border-t border-slate-200",children:[e.jsx("button",{type:"button",onClick:()=>{j(!1),g(null)},className:"px-4 py-2 text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors",children:t?"Simpan Perubahan":"Cipta Pengguna"})]})]})]})}),e.jsx(Z,{show:!!m,onClose:()=>h(null),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-slate-900",children:"Padam Pengguna"}),e.jsxs("p",{className:"mt-1 text-sm text-slate-600",children:["Adakah anda pasti mahu memadam pengguna ",e.jsx("span",{className:"font-semibold",children:m?.name}),"?",m?.status==="rejected"&&e.jsx("span",{className:"block mt-2 text-rose-600",children:'Pengguna ini mempunyai status "Ditolak".'}),"Tindakan ini tidak boleh dibatalkan."]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(se,{onClick:()=>h(null),children:"Batal"}),e.jsx(ee,{onClick:M,children:"Padam Pengguna"})]})]})})]})}export{ye as default};
