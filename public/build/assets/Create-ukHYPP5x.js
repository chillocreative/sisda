import{r as i,u as Y,j as e,H as z,c as C}from"./app-BWq0V4VU.js";import{A as W,X}from"./AuthenticatedLayout-DcCfx-XQ.js";import{A as Q,L as V}from"./AsyncSearchableSelectWithCallback-BoH3-Jdo.js";import{A as Z}from"./arrow-left-CdEUy7UM.js";import{U as $,I as ee}from"./upload-BsNWBUE7.js";import"./createLucideIcon-Cu-hceAs.js";import"./phone-M3OndM0L.js";import"./check-CpS1hXiM.js";import"./index-D1bIYtbT.js";import"./portal-BLyrXB8G.js";import"./transition-pqTiJHfC.js";import"./with-selector-DELMSVCd.js";function ge({bangsaList:S,negeriList:ae,bandarList:se,kadunList:te,daerahMengundiList:le,jenisSumbanganList:D,tujuanSumbanganList:M,bantuanLainList:I,keahlianPartiList:L,kecenderunganPolitikList:K}){const[U,u]=i.useState(0),[m,g]=i.useState(!1),[j,f]=i.useState(null),[q,x]=i.useState([]),[N,v]=i.useState(!1),[A,h]=i.useState([]),[k,_]=i.useState(!1),{data:t,setData:l,post:O,processing:y,errors:s}=Y({nama:"",no_ic:"",umur:"",no_tel:"",bangsa:"",alamat:"",poskod:"",negeri:"",bandar:"",kadun:"",daerah_mengundi:"",bil_isi_rumah:"",pendapatan_isi_rumah:"",pekerjaan:"",pemilik_rumah:"",jenis_sumbangan:"",tujuan_sumbangan:"",bantuan_lain:"",keahlian_parti:"",kecenderungan_politik:"",kad_pengenalan:null,nota:""});i.useEffect(()=>{(async()=>{if(!t.bandar){x([]);return}v(!0);try{const n=await C.get(route("api.kadun.by-bandar"),{params:{bandar:t.bandar}});x(n.data)}catch(n){console.error("Error fetching KADUN:",n),x([])}finally{v(!1)}})()},[t.bandar]),i.useEffect(()=>{(async()=>{if(!t.bandar){h([]);return}_(!0);try{const n=await C.get(route("api.daerah-mengundi.by-bandar"),{params:{bandar:t.bandar}});h(n.data)}catch(n){console.error("Error fetching Daerah Mengundi:",n),h([])}finally{_(!1)}})()},[t.bandar]);const B=a=>{const n=a.target.files[0];if(!n)return;if(!n.type.startsWith("image/")){alert("Sila pilih fail imej sahaja");return}if(n.size>5*1024*1024){alert("Saiz fail terlalu besar. Maksimum 5MB");return}const r=new FileReader;r.onloadend=()=>{f(r.result)},r.readAsDataURL(n),g(!0),u(0);const d=setInterval(()=>{u(o=>o>=100?(clearInterval(d),g(!1),l("kad_pengenalan",n),100):o+10)},100)},R=()=>{l("kad_pengenalan",null),f(null),u(0)},E=a=>{const r=a.target.value.replace(/\D/g,"");if(r.length>12)return;if(l("no_ic",r),r.length<6){l("umur","");return}const d=r.substring(0,2),o=r.substring(2,4),J=r.substring(4,6),G=parseInt(d)<=25?2e3+parseInt(d):1900+parseInt(d),p=new Date(G,parseInt(o)-1,parseInt(J)),b=new Date;let c=b.getFullYear()-p.getFullYear();const P=b.getMonth()-p.getMonth();(P<0||P===0&&b.getDate()<p.getDate())&&c--,c>=0&&c<=150&&l("umur",c.toString())},F=a=>{const r=a.target.value.replace(/\D/g,"");l("no_tel",r)},w=(a,n)=>{l(a,n.toUpperCase())},T=a=>{a&&l(n=>({...n,poskod:a.postcode,negeri:a.negeri_nama||"",bandar:a.bandar_nama||"",kadun:""}))},H=a=>{a.preventDefault(),O(route("reports.hasil-culaan.store"))};return e.jsxs(W,{children:[e.jsx(z,{title:"Tambah Hasil Culaan"}),e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>window.history.back(),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(Z,{className:"h-5 w-5 text-slate-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Tambah Hasil Culaan"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Isi semua maklumat yang diperlukan"})]})]}),e.jsxs("form",{onSubmit:H,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Maklumat Peribadi"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Nama ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.nama,onChange:a=>w("nama",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400 uppercase",required:!0}),s.nama&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.nama})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["No. IC ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.no_ic,onChange:E,placeholder:"900101145678",maxLength:"12",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0}),s.no_ic&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.no_ic}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Hanya angka sahaja (contoh: 900101145678)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Umur ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"number",value:t.umur,onChange:a=>l("umur",a.target.value),min:"1",max:"150",readOnly:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400 bg-slate-50",required:!0}),s.umur&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.umur}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Dikira automatik dari No. IC"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["No. Telefon ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"tel",value:t.no_tel,onChange:F,placeholder:"0123456789",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0}),s.no_tel&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.no_tel}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Hanya angka sahaja"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Bangsa ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("select",{value:t.bangsa,onChange:a=>l("bangsa",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0,children:[e.jsx("option",{value:"",children:"Pilih Bangsa"}),S.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),s.bangsa&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.bangsa})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Maklumat Alamat"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Alamat ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("textarea",{value:t.alamat,onChange:a=>w("alamat",a.target.value),rows:"3",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400 uppercase",required:!0}),s.alamat&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.alamat})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Poskod ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx(Q,{value:t.poskod,onChange:a=>l("poskod",a),onSelect:T,routeName:"api.postcodes.search-details",placeholder:"00000",displayField:"postcode"}),s.poskod&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.poskod})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Negeri ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.negeri,readOnly:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400 bg-slate-50",placeholder:"Pilih Poskod terlebih dahulu"}),s.negeri&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.negeri})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Bandar ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.bandar,readOnly:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400 bg-slate-50",placeholder:"Pilih Poskod terlebih dahulu"}),s.bandar&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.bandar})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["KADUN ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),t.bandar?e.jsxs("select",{value:t.kadun,onChange:a=>l("kadun",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",disabled:N,required:!0,children:[e.jsx("option",{value:"",children:N?"Loading...":"Pilih KADUN"}),q.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}):e.jsx("input",{type:"text",value:"",readOnly:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg bg-slate-100 text-slate-500",placeholder:"Pilih Poskod terlebih dahulu"}),s.kadun&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.kadun})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Daerah Mengundi ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),t.bandar?e.jsxs("select",{value:t.daerah_mengundi,onChange:a=>l("daerah_mengundi",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",disabled:k,required:!0,children:[e.jsx("option",{value:"",children:k?"Loading...":"Pilih Daerah Mengundi"}),A.map(a=>e.jsxs("option",{value:a.nama,children:[a.kod_dm," - ",a.nama]},a.id))]}):e.jsx("input",{type:"text",value:"",readOnly:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg bg-slate-100 text-slate-500",placeholder:"Pilih Poskod terlebih dahulu"}),s.daerah_mengundi&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.daerah_mengundi})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Maklumat Isi Rumah"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Bilangan Isi Rumah ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"number",value:t.bil_isi_rumah,onChange:a=>l("bil_isi_rumah",a.target.value),min:"1",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0}),s.bil_isi_rumah&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.bil_isi_rumah})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Pendapatan Isi Rumah (RM) ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"number",value:t.pendapatan_isi_rumah,onChange:a=>l("pendapatan_isi_rumah",a.target.value),min:"0",step:"0.01",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0}),s.pendapatan_isi_rumah&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.pendapatan_isi_rumah})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Pekerjaan ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.pekerjaan,onChange:a=>l("pekerjaan",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0}),s.pekerjaan&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.pekerjaan})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Pemilik Rumah ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("select",{value:t.pemilik_rumah,onChange:a=>l("pemilik_rumah",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0,children:[e.jsx("option",{value:"",children:"Pilih Status"}),e.jsx("option",{value:"Sendiri",children:"Sendiri"}),e.jsx("option",{value:"Sewa",children:"Sewa"}),e.jsx("option",{value:"Keluarga",children:"Keluarga"}),e.jsx("option",{value:"Lain-lain",children:"Lain-lain"})]}),s.pemilik_rumah&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.pemilik_rumah})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Maklumat Bantuan & Politik"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Jenis Sumbangan"}),e.jsxs("select",{value:t.jenis_sumbangan,onChange:a=>l("jenis_sumbangan",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",children:[e.jsx("option",{value:"",children:"Pilih Jenis Sumbangan"}),D.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),s.jenis_sumbangan&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.jenis_sumbangan})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Tujuan Sumbangan"}),e.jsxs("select",{value:t.tujuan_sumbangan,onChange:a=>l("tujuan_sumbangan",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",children:[e.jsx("option",{value:"",children:"Pilih Tujuan Sumbangan"}),M.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),s.tujuan_sumbangan&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.tujuan_sumbangan})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Bantuan Lain"}),e.jsxs("select",{value:t.bantuan_lain,onChange:a=>l("bantuan_lain",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",children:[e.jsx("option",{value:"",children:"Pilih Bantuan Lain"}),I.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),s.bantuan_lain&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.bantuan_lain})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Keahlian Parti"}),e.jsxs("select",{value:t.keahlian_parti,onChange:a=>l("keahlian_parti",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",children:[e.jsx("option",{value:"",children:"Pilih Keahlian Parti"}),L.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),s.keahlian_parti&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.keahlian_parti})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Kecenderungan Politik"}),e.jsxs("select",{value:t.kecenderungan_politik,onChange:a=>l("kecenderungan_politik",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",children:[e.jsx("option",{value:"",children:"Pilih Kecenderungan Politik"}),K.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),s.kecenderungan_politik&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.kecenderungan_politik})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Dokumen & Nota"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Kad Pengenalan"}),j?e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative w-full h-48 bg-slate-100 rounded-lg overflow-hidden",children:[e.jsx("img",{src:j,alt:"Preview Kad Pengenalan",className:"w-full h-full object-contain",onError:a=>{a.target.onerror=null,a.target.src="https://placehold.co/600x400?text=Imej+Tidak+Dijumpai",a.target.className="w-full h-full object-contain opacity-50"}}),m&&e.jsxs("div",{className:"absolute inset-0 bg-black/50 flex flex-col items-center justify-center",children:[e.jsx(V,{className:"h-8 w-8 text-white animate-spin mb-2"}),e.jsxs("span",{className:"text-white text-sm font-medium",children:[U,"%"]})]})]}),!m&&e.jsx("button",{type:"button",onClick:R,className:"absolute top-2 right-2 p-1.5 bg-rose-600 text-white rounded-lg hover:bg-rose-700 transition-colors",children:e.jsx(X,{className:"h-4 w-4"})}),t.kad_pengenalan&&e.jsxs("p",{className:"text-sm text-slate-600 mt-2 flex items-center",children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),t.kad_pengenalan.name]})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:B,className:"hidden",id:"kad-pengenalan-upload",disabled:m}),e.jsxs("label",{htmlFor:"kad-pengenalan-upload",className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-slate-300 rounded-lg cursor-pointer hover:border-slate-400 hover:bg-slate-50 transition-colors",children:[e.jsx($,{className:"h-8 w-8 text-slate-400 mb-2"}),e.jsx("span",{className:"text-sm text-slate-600",children:"Klik untuk muat naik imej"}),e.jsx("span",{className:"text-xs text-slate-500 mt-1",children:"PNG, JPG, JPEG (Maks. 5MB)"})]})]}),s.kad_pengenalan&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.kad_pengenalan})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nota"}),e.jsx("textarea",{value:t.nota,onChange:a=>l("nota",a.target.value),rows:"4",placeholder:"Catatan tambahan...",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400"}),s.nota&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:s.nota})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pb-6",children:[e.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"px-6 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",disabled:y,className:"px-6 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors disabled:opacity-50",children:y?"Menyimpan...":"Simpan"})]})]})]})]})}export{ge as default};
