import{r as n,u as Z,j as e,H as $,d as c}from"./app-D0qDnIdI.js";import{A as ee}from"./AuthenticatedLayout-Dv3_JOXg.js";import{A as ae}from"./arrow-left-e_qTqI7q.js";import"./createLucideIcon-DSPYBP-L.js";import"./phone-DeDdUclu.js";function ue({dataPengundi:i,bangsaList:E,negeriList:P,bandarList:se,parlimenList:te,kadunList:le,daerahMengundiList:re,keahlianPartiList:L,kecenderunganPolitikList:q,lokalitiList:v}){const[O,x]=n.useState([]),[A,y]=n.useState(!1),[I,h]=n.useState([]),[R,w]=n.useState(!1),[B,p]=n.useState([]),[U,_]=n.useState(!1),[F,g]=n.useState([]),[H,D]=n.useState(!1),[M,d]=n.useState([]),[T,u]=n.useState(!1),b=n.useRef(null),f=n.useRef(null),{data:s,setData:r,put:Y,processing:C,errors:t}=Z({nama:i.nama||"",no_ic:i.no_ic||"",umur:i.umur||"",no_tel:i.no_tel||"",bangsa:i.bangsa||"",alamat:i.alamat||"",poskod:i.poskod||"",negeri:i.negeri||"",bandar:i.bandar||"",parlimen:i.parlimen||"",kadun:i.kadun||"",mpkk:i.mpkk||"",daerah_mengundi:i.daerah_mengundi||"",lokaliti:i.lokaliti||"",keahlian_parti:i.keahlian_parti||"",kecenderungan_politik:i.kecenderungan_politik||""});n.useEffect(()=>{(async()=>{if(!s.negeri){x([]);return}y(!0);try{const l=await c.get(route("api.parlimen.by-negeri"),{params:{negeri:s.negeri}});x(l.data)}catch(l){console.error("Error fetching Parlimen:",l),x([])}finally{y(!1)}})()},[s.negeri]),n.useEffect(()=>{(async()=>{if(!s.parlimen){h([]);return}w(!0);try{const l=await c.get(route("api.kadun.by-bandar"),{params:{bandar:s.parlimen}});h(l.data)}catch(l){console.error("Error fetching KADUN:",l),h([])}finally{w(!1)}})()},[s.parlimen]),n.useEffect(()=>{(async()=>{if(!s.kadun){g([]);return}D(!0);try{const l=await c.get(route("api.mpkk.by-kadun"),{params:{kadun:s.kadun}});g(l.data)}catch(l){console.error("Error fetching MPKK:",l),g([])}finally{D(!1)}})()},[s.kadun]),n.useEffect(()=>{(async()=>{if(!s.parlimen){p([]);return}_(!0);try{const l=await c.get(route("api.daerah-mengundi.by-bandar"),{params:{bandar:s.parlimen}});p(l.data)}catch(l){console.error("Error fetching Daerah Mengundi:",l),p([])}finally{_(!1)}})()},[s.parlimen]),n.useEffect(()=>{(async()=>{if(s.poskod.length===5)try{const l=await c.get(route("api.postcodes.search-details"),{params:{query:s.poskod}});if(l.data&&l.data.length>0){const o=l.data[0];r({...s,negeri:o.negeri_nama||"",bandar:o.city||"",parlimen:o.bandar_nama||""})}}catch(l){console.error("Error fetching postcode details:",l)}})()},[s.poskod]),n.useEffect(()=>{const a=l=>{f.current&&!f.current.contains(l.target)&&u(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);const z=a=>{r({...s,no_ic:a.no_ic,nama:a.nama||s.nama,lokaliti:a.lokaliti||s.lokaliti,daerah_mengundi:a.daerah_mengundi||s.daerah_mengundi,kadun:a.kadun||s.kadun,parlimen:a.parlimen||s.parlimen,negeri:a.negeri||s.negeri,bangsa:a.bangsa||s.bangsa}),u(!1),d([])},W=a=>{const l=a.target.value.replace(/\D/g,"");l.length<=5&&r("poskod",l)},G=a=>{const o=a.target.value.replace(/\D/g,"");if(o.length>12)return;if(r("no_ic",o),b.current&&clearTimeout(b.current),o.length>=3?b.current=setTimeout(()=>{c.get(route("api.voter.suggest-ic"),{params:{ic:o}}).then(K=>{d(K.data||[]),u((K.data||[]).length>0)}).catch(()=>d([]))},300):(d([]),u(!1)),o.length<6){r("umur","");return}const j=o.substring(0,2),Q=o.substring(2,4),V=o.substring(4,6),X=parseInt(j)<=25?2e3+parseInt(j):1900+parseInt(j),k=new Date(X,parseInt(Q)-1,parseInt(V)),N=new Date;let m=N.getFullYear()-k.getFullYear();const S=N.getMonth()-k.getMonth();(S<0||S===0&&N.getDate()<k.getDate())&&m--,m>=0&&m<=150&&r("umur",m.toString())},J=a=>{a.preventDefault(),Y(route("reports.data-pengundi.update",i.id))};return e.jsxs(ee,{children:[e.jsx($,{title:"Edit Data Pengundi"}),e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>window.history.back(),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(ae,{className:"h-5 w-5 text-slate-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Edit Data Pengundi"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Kemaskini maklumat pengundi"})]})]}),e.jsxs("form",{onSubmit:J,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Maklumat Peribadi"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Nama ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"text",value:s.nama,onChange:a=>r("nama",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0}),t.nama&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.nama})]}),e.jsxs("div",{ref:f,className:"relative",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["No. IC ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"text",value:s.no_ic,onChange:G,placeholder:"900101145678",maxLength:"12",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0}),t.no_ic&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.no_ic}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Hanya angka sahaja (contoh: 900101145678)"}),T&&M.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-slate-200 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:M.map(a=>e.jsxs("button",{type:"button",onClick:()=>z(a),className:"w-full text-left px-4 py-2.5 hover:bg-slate-50 transition-colors border-b border-slate-100 last:border-0",children:[e.jsx("span",{className:"font-mono text-sm font-medium text-slate-900",children:a.no_ic}),e.jsx("span",{className:"ml-2 text-sm text-slate-500",children:a.nama})]},a.no_ic))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Umur ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"number",value:s.umur,onChange:a=>r("umur",a.target.value),min:"1",max:"150",readOnly:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400 bg-slate-50",required:!0}),t.umur&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.umur}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Dikira automatik dari No. IC"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["No. Telefon ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"tel",value:s.no_tel,onChange:a=>r("no_tel",a.target.value),placeholder:"0123456789",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0}),t.no_tel&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.no_tel})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Bangsa ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("select",{value:s.bangsa,onChange:a=>r("bangsa",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0,children:[e.jsx("option",{value:"",children:"Pilih Bangsa"}),E.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),t.bangsa&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.bangsa})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Maklumat Alamat"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Alamat ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("textarea",{value:s.alamat,onChange:a=>r("alamat",a.target.value),rows:"3",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0}),t.alamat&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.alamat})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Poskod ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"text",value:s.poskod,onChange:W,placeholder:"00000",maxLength:"5",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0}),t.poskod&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.poskod})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Negeri ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("select",{value:s.negeri,onChange:a=>r("negeri",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0,children:[e.jsx("option",{value:"",children:"Pilih Negeri"}),P.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),t.negeri&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.negeri})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Bandar ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsx("input",{type:"text",value:s.bandar,readOnly:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400 bg-slate-50",placeholder:"Pilih Poskod terlebih dahulu"}),t.bandar&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.bandar})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Parlimen ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("select",{value:s.parlimen,onChange:a=>r("parlimen",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0,children:[e.jsx("option",{value:"",children:A?"Memuat...":"Pilih Parlimen"}),O.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),t.parlimen&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.parlimen})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["KADUN ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("select",{value:s.kadun,onChange:a=>r("kadun",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0,children:[e.jsx("option",{value:"",children:R?"Memuat...":"Pilih KADUN"}),I.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),t.kadun&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.kadun})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["MPKK ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("select",{value:s.mpkk,onChange:a=>r("mpkk",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0,children:[e.jsx("option",{value:"",children:H?"Memuat...":"Pilih MPKK"}),F.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),t.mpkk&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.mpkk})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Daerah Mengundi ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("select",{value:s.daerah_mengundi,onChange:a=>r("daerah_mengundi",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",required:!0,children:[e.jsx("option",{value:"",children:U?"Memuat...":"Pilih Daerah Mengundi"}),B.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),t.daerah_mengundi&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.daerah_mengundi})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Lokaliti"}),e.jsxs("select",{value:s.lokaliti,onChange:a=>r("lokaliti",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",children:[e.jsx("option",{value:"",children:"Pilih Lokaliti"}),v&&v.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),t.lokaliti&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.lokaliti})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Maklumat Politik"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Keahlian Parti"}),e.jsxs("select",{value:s.keahlian_parti,onChange:a=>r("keahlian_parti",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",children:[e.jsx("option",{value:"",children:"Pilih Keahlian Parti"}),L.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),t.keahlian_parti&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.keahlian_parti})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Kecenderungan Politik"}),e.jsxs("select",{value:s.kecenderungan_politik,onChange:a=>r("kecenderungan_politik",a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400",children:[e.jsx("option",{value:"",children:"Pilih Kecenderungan Politik"}),q.map(a=>e.jsx("option",{value:a.nama,children:a.nama},a.id))]}),t.kecenderungan_politik&&e.jsx("p",{className:"text-sm text-rose-600 mt-1",children:t.kecenderungan_politik})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pb-6",children:[e.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"px-6 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",disabled:C,className:"px-6 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors disabled:opacity-50",children:C?"Menyimpan...":"Simpan"})]})]})]})]})}export{ue as default};
