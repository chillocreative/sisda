import{a as B,r as u,u as H,j as e,H as $,b as i}from"./app-D0qDnIdI.js";import{A as K,c as U,X as f}from"./AuthenticatedLayout-Dv3_JOXg.js";import{M as y}from"./Modal-DbXnBxva.js";import{S as V}from"./SecondaryButton-BrBzkf7X.js";import{u as z}from"./useDragScroll-D4thvRKI.js";import{D as k}from"./download-R5rcMu1v.js";import{P as J,S as O}from"./square-pen-CSTnRSTi.js";import{F as Y}from"./funnel-CUVJODuC.js";import{S as q}from"./search-DbDLyklp.js";import{C as w}from"./calendar-DimcekCS.js";import{E as g}from"./eye-DIRC9fY5.js";import{c as W}from"./createLucideIcon-DSPYBP-L.js";import{T as _}from"./trash-2-oLL1srqK.js";import"./phone-DeDdUclu.js";import"./transition-CgqZx-gA.js";import"./with-selector-DyWmyi4b.js";import"./index-BEH4CO9d.js";const X=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],S=W("file-down",X);function pe({hasilCulaan:a,filters:p,currentUserId:G}){const{auth:C}=B().props,r=C.user,[l,c]=u.useState([]),[o,T]=u.useState(!1),[t,d]=u.useState(null),[j,b]=u.useState(null),P=z(),N=s=>r.role==="super_admin"?!0:r.role==="admin"?s.bandar===r.bandar?.nama:r.role==="user"?s.submitted_by?.id===r.id&&s.kadun===r.kadun?.nama:!1,m=a.data.filter(N),{data:n,setData:h,get:D,processing:I}=H({search:p.search||"",date_from:p.date_from||"",date_to:p.date_to||""}),M=s=>{s.preventDefault(),D(route("reports.hasil-culaan.index"),{preserveState:!0,preserveScroll:!0})},L=()=>{const s=new URLSearchParams({search:n.search,date_from:n.date_from,date_to:n.date_to}).toString();window.location.href=route("reports.hasil-culaan.export")+"?"+s},F=s=>{s.target.checked?c(m.map(x=>x.id)):c([])},E=s=>{l.includes(s)?c(l.filter(x=>x!==s)):c([...l,s])},R=s=>{confirm("Adakah anda pasti mahu memadam rekod ini?")&&i.delete(route("reports.hasil-culaan.destroy",s))},A=s=>new Date(s).toLocaleDateString("ms-MY",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),v=s=>"RM "+parseFloat(s).toLocaleString("ms-MY",{minimumFractionDigits:2,maximumFractionDigits:2});return e.jsxs(K,{children:[e.jsx($,{title:"Hasil Culaan"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Hasil Culaan"}),e.jsxs("p",{className:"text-sm text-slate-600 mt-1",children:["Jumlah: ",a.total," rekod"]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:L,className:"flex items-center space-x-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:"Export Excel"})]}),e.jsxs("button",{onClick:()=>i.visit(route("reports.hasil-culaan.create")),className:"flex items-center space-x-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{children:"Tambah Baru"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-slate-900 flex items-center space-x-2",children:[e.jsx(Y,{className:"h-5 w-5"}),e.jsx("span",{children:"Penapis"})]}),e.jsxs("button",{onClick:()=>T(!o),className:"text-sm text-slate-600 hover:text-slate-900 flex items-center space-x-1",children:[e.jsx("span",{children:o?"Sembunyikan":"Tunjukkan"}),e.jsx(U,{className:`h-4 w-4 transition-transform ${o?"rotate-180":""}`})]})]}),o&&e.jsxs("form",{onSubmit:M,className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Carian"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",value:n.search,onChange:s=>h("search",s.target.value),placeholder:"Nama, No. IC, No. Tel",className:"w-full pl-10 pr-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Tarikh Dari"}),e.jsxs("div",{className:"relative",children:[e.jsx(w,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"date",value:n.date_from,onChange:s=>h("date_from",s.target.value),className:"w-full pl-10 pr-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Tarikh Hingga"}),e.jsxs("div",{className:"relative",children:[e.jsx(w,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"date",value:n.date_to,onChange:s=>h("date_to",s.target.value),className:"w-full pl-10 pr-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-400 focus:border-slate-400"})]})]}),e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsx("button",{type:"submit",disabled:I,className:"flex-1 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors disabled:opacity-50",children:"Tapis"}),e.jsx("button",{type:"button",onClick:()=>{h({search:"",date_from:"",date_to:""}),i.visit(route("reports.hasil-culaan.index"))},className:"px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Reset"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:[e.jsx("div",{ref:P,className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 w-12",children:e.jsx("input",{type:"checkbox",checked:m.length>0&&m.every(s=>l.includes(s.id)),onChange:F,className:"rounded border-slate-300 disabled:opacity-50",disabled:m.length===0})}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-semibold text-slate-600 uppercase",children:"Nama"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-semibold text-slate-600 uppercase",children:"No. IC"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-semibold text-slate-600 uppercase",children:"Umur"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-semibold text-slate-600 uppercase",children:"No. Tel"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-semibold text-slate-600 uppercase",children:"Bangsa"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-semibold text-slate-600 uppercase",children:"Negeri"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-semibold text-slate-600 uppercase",children:"Bandar"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-semibold text-slate-600 uppercase",children:"Lokaliti"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-semibold text-slate-600 uppercase",children:"Pendapatan"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-semibold text-slate-600 uppercase",children:"Tarikh"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-semibold text-slate-600 uppercase",children:"Dikemukakan"}),e.jsx("th",{className:"text-center py-3 px-4 text-xs font-semibold text-slate-600 uppercase",children:"Kad Pengenalan"}),e.jsx("th",{className:"text-right py-3 px-4 text-xs font-semibold text-slate-600 uppercase",children:"Tindakan"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:a.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"14",className:"py-8 text-center text-slate-500",children:"Tiada rekod dijumpai"})}):a.data.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"py-3 px-4",children:N(s)&&e.jsx("input",{type:"checkbox",checked:l.includes(s.id),onChange:()=>E(s.id),className:"rounded border-slate-300"})}),e.jsx("td",{className:"py-3 px-4 text-sm font-medium text-slate-900",children:e.jsx("button",{onClick:()=>d(s),className:"hover:text-sky-600 hover:underline text-left",children:s.nama})}),e.jsx("td",{className:"py-3 px-4 text-sm text-slate-600",children:s.no_ic}),e.jsx("td",{className:"py-3 px-4 text-sm text-slate-600",children:s.umur}),e.jsx("td",{className:"py-3 px-4 text-sm text-slate-600",children:s.no_tel}),e.jsx("td",{className:"py-3 px-4 text-sm text-slate-600",children:s.bangsa}),e.jsx("td",{className:"py-3 px-4 text-sm text-slate-600",children:s.negeri}),e.jsx("td",{className:"py-3 px-4 text-sm text-slate-600",children:s.bandar}),e.jsx("td",{className:"py-3 px-4 text-sm text-slate-600",children:s.lokaliti||"â€”"}),e.jsx("td",{className:"py-3 px-4 text-sm text-slate-600",children:v(s.pendapatan_isi_rumah)}),e.jsx("td",{className:"py-3 px-4 text-sm text-slate-600",children:A(s.created_at)}),e.jsx("td",{className:"py-3 px-4 text-sm text-slate-600",children:s.submitted_by?.name||"-"}),e.jsx("td",{className:"py-3 px-4",children:s.kad_pengenalan?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("a",{href:`/storage/${s.kad_pengenalan}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-slate-600 hover:text-sky-600 hover:bg-sky-50 rounded-lg transition-colors",title:"Lihat",children:e.jsx(g,{className:"h-4 w-4"})}),e.jsx("a",{href:`/storage/${s.kad_pengenalan}`,download:!0,className:"p-2 text-slate-600 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",title:"Muat Turun",children:e.jsx(S,{className:"h-4 w-4"})})]}):e.jsx("div",{className:"text-center text-slate-400 text-xs",children:"Tiada"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"flex items-center justify-end space-x-2",children:N(s)?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>i.visit(route("reports.hasil-culaan.edit",s.id)),className:"p-2 text-slate-600 hover:text-sky-600 hover:bg-sky-50 rounded-lg transition-colors",title:"Edit",children:e.jsx(O,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>R(s.id),className:"p-2 text-slate-600 hover:text-rose-600 hover:bg-rose-50 rounded-lg transition-colors",title:"Padam",children:e.jsx(_,{className:"h-4 w-4"})})]}):e.jsx("button",{onClick:()=>d(s),className:"p-2 text-slate-600 hover:text-sky-600 hover:bg-sky-50 rounded-lg transition-colors",title:"Lihat",children:e.jsx(g,{className:"h-4 w-4"})})})})]},s.id))})]})}),a.links&&a.links.length>3&&e.jsx("div",{className:"border-t border-slate-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-slate-600",children:["Menunjukkan ",a.from," hingga ",a.to," daripada ",a.total," rekod"]}),e.jsx("div",{className:"flex items-center space-x-2",children:a.links.map((s,x)=>e.jsx("button",{onClick:()=>s.url&&i.visit(s.url),disabled:!s.url,className:`px-3 py-1 rounded-lg text-sm transition-colors ${s.active?"bg-slate-900 text-white":s.url?"bg-slate-100 text-slate-700 hover:bg-slate-200":"bg-slate-50 text-slate-400 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:s.label}},x))})]})})]}),l.length>0&&e.jsxs("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 bg-slate-900 text-white rounded-xl shadow-xl px-6 py-4 flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:[l.length," item dipilih"]}),e.jsxs("button",{onClick:()=>{confirm(`Padam ${l.length} item?`)&&i.post(route("reports.hasil-culaan.bulk-delete"),{ids:l})},className:"flex items-center space-x-2 px-4 py-2 bg-rose-600 rounded-lg hover:bg-rose-700 transition-colors",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx("span",{children:"Padam Semua"})]}),e.jsx("button",{onClick:()=>c([]),className:"p-2 hover:bg-slate-800 rounded-lg transition-colors",children:e.jsx(f,{className:"h-4 w-4"})})]})]}),e.jsx(y,{show:!!t,onClose:()=>d(null),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-slate-900",children:"Maklumat Hasil Culaan"}),e.jsx("button",{onClick:()=>d(null),className:"text-slate-400 hover:text-slate-500",children:e.jsx(f,{className:"h-5 w-5"})})]}),t&&e.jsxs("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto pr-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Nama"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.nama})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"No. Kad Pengenalan"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.no_ic})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Umur"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.umur})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"No. Telefon"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.no_tel})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Bangsa"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.bangsa})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Alamat"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.alamat})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Poskod"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.poskod})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Bandar"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.bandar})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Negeri"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.negeri})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"KADUN"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.kadun})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Bil Isi Rumah"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.bil_isi_rumah})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Pendapatan Isi Rumah"}),e.jsx("div",{className:"mt-1 text-slate-900",children:v(t.pendapatan_isi_rumah)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Pekerjaan"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.pekerjaan||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Pemilik Rumah"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.pemilik_rumah||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Jenis Sumbangan"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.jenis_sumbangan||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Tujuan Sumbangan"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.tujuan_sumbangan||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Dikemukakan Oleh"}),e.jsx("div",{className:"mt-1 text-slate-900",children:t.submitted_by?.name||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500",children:"Kad Pengenalan (Lampiran)"}),t.kad_pengenalan?e.jsxs("div",{className:"mt-1 flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>b(`/storage/${t.kad_pengenalan}`),className:"text-sky-600 hover:text-sky-700 hover:underline flex items-center space-x-1",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{children:"Lihat"})]}),e.jsxs("a",{href:`/storage/${t.kad_pengenalan}`,download:!0,className:"text-emerald-600 hover:text-emerald-700 hover:underline flex items-center space-x-1",children:[e.jsx(S,{className:"h-4 w-4"}),e.jsx("span",{children:"Muat Turun"})]})]}):e.jsx("div",{className:"mt-1 text-slate-400",children:"Tiada"})]})]}),e.jsx("div",{className:"flex justify-end pt-6 border-t border-slate-100",children:e.jsx(V,{onClick:()=>d(null),children:"Tutup"})})]})]})}),e.jsx(y,{show:!!j,onClose:()=>b(null),maxWidth:"4xl",children:e.jsxs("div",{className:"relative p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-slate-900",children:"Lampiran Kad Pengenalan"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("a",{href:j,download:!0,className:"p-2 text-slate-500 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",title:"Muat Turun",children:e.jsx(k,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>b(null),className:"p-2 text-slate-500 hover:text-rose-600 hover:bg-rose-50 rounded-lg transition-colors",title:"Tutup",children:e.jsx(f,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex items-center justify-center bg-slate-100 rounded-lg p-2",children:e.jsx("img",{src:j,alt:"Kad Pengenalan",className:"max-w-full max-h-[75vh] object-contain rounded",onError:s=>{s.target.onerror=null,s.target.src="https://placehold.co/600x400?text=Imej+Tidak+Dijumpai",s.target.className="max-w-full max-h-[75vh] object-contain rounded opacity-50"}})})]})})]})}export{pe as default};
